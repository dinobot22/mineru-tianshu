# ============================================================================
# Tianshu (天枢) - 环境变量配置示例
# ============================================================================
#
# 使用方式：
#   1. 复制此文件为 .env: cp .env.example .env
#   2. 根据实际情况修改配置
#   3. 使用 docker-compose up -d 启动服务
#
# ============================================================================

# ----------------------------------------------------------------------------
# 应用配置
# ----------------------------------------------------------------------------
API_PORT=8000
WORKER_PORT=8001
MCP_PORT=8002
FRONTEND_PORT=80

LOG_LEVEL=INFO

# ----------------------------------------------------------------------------
# JWT 认证配置
# ----------------------------------------------------------------------------
# 重要：生产环境请修改为随机字符串！
# 生成方式: openssl rand -hex 32
JWT_SECRET_KEY=your-secret-key-change-in-production
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# ----------------------------------------------------------------------------
# CORS 配置
# ----------------------------------------------------------------------------
ALLOWED_ORIGINS=http://localhost:5173,http://localhost:80

# ----------------------------------------------------------------------------
# GPU 配置
# ----------------------------------------------------------------------------
# GPU 数量（Docker 分配）
GPU_COUNT=1

# 可见的 GPU 设备（Backend，逗号分隔）
CUDA_VISIBLE_DEVICES=0

# 每个 GPU 的 Worker 数量
WORKER_GPUS=2

# Worker 批处理大小
MAX_BATCH_SIZE=4

# Worker 超时时间（秒）
WORKER_TIMEOUT=300

# ----------------------------------------------------------------------------
# 文件配置
# ----------------------------------------------------------------------------
# 最大文件大小（字节，0 表示不限制）
MAX_FILE_SIZE=0

# Nginx 文件上传大小限制（0 表示不限制）
NGINX_CLIENT_MAX_BODY_SIZE=0

# ----------------------------------------------------------------------------
# 数据库配置
# ----------------------------------------------------------------------------
DATABASE_PATH=/app/data/db/mineru_tianshu.db

# ----------------------------------------------------------------------------
# 模型下载配置
# ----------------------------------------------------------------------------
# 模型下载源: modelscope (国内推荐) | huggingface | auto
MODEL_DOWNLOAD_SOURCE=auto

# HuggingFace 镜像地址（国内加速）
HF_ENDPOINT=https://hf-mirror.com

# MinerU 虚拟显存大小（GB，auto 表示自动检测）
# MINERU_VIRTUAL_VRAM_SIZE=6

# ----------------------------------------------------------------------------
# RustFS 对象存储配置（必须配置）
# ----------------------------------------------------------------------------
# RustFS 服务地址（容器内部）
RUSTFS_ENDPOINT=rustfs:9000

# RustFS 访问密钥（生产环境请修改！）
RUSTFS_ACCESS_KEY=rustfsadmin
RUSTFS_SECRET_KEY=rustfsadmin

# RustFS 存储桶名称
RUSTFS_BUCKET=ts-img

# RustFS 是否使用 HTTPS
RUSTFS_SECURE=false

# RustFS 公开访问 URL（外部访问地址，必须配置！）
#
# ⚠️  重要：必须设置为外部可访问的完整 URL
# ❌ 不要使用: http://localhost:9000, http://127.0.0.1:9000, http://172.x.x.x:9000
# ✅ 使用示例:
#    - 局域网: RUSTFS_PUBLIC_URL=http://192.168.1.100:9000
#    - 公网: RUSTFS_PUBLIC_URL=http://your-domain.com:9000
#    - HTTPS: RUSTFS_PUBLIC_URL=https://files.your-domain.com
#    - Windows/WSL: 使用 Windows 主机的 IP (在 Windows 中运行 ipconfig 查看)
#
# 获取 Windows IP 的方法:
#   1. 在 Windows PowerShell 或 CMD 中运行: ipconfig
#   2. 找到 "IPv4 地址"，例如: 192.168.1.100
#   3. 设置: RUSTFS_PUBLIC_URL=http://192.168.1.100:9000
#
RUSTFS_PUBLIC_URL=http://192.168.1.100:9000

# RustFS 服务端口
RUSTFS_PORT=9000
RUSTFS_CONSOLE_PORT=9001

# ----------------------------------------------------------------------------
# MCP Server 配置（可选）
# ----------------------------------------------------------------------------
API_URL=http://backend:8000

# ----------------------------------------------------------------------------
# 前端配置
# ----------------------------------------------------------------------------
VITE_API_BASE_URL=http://localhost:8000
